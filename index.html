<style>
body {
    background: #f9f2e8;
    font-family: 'Comic Sans MS', cursive;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
}

.nugget {
    width: 100px;
    height: 70px;
    background: #f4b942;
    border-radius: 30px;
    position: relative;
    cursor: pointer;
    box-shadow: 3px 3px 10px rgba(0,0,0,0.2);
    transition: transform 0.2s;
}

.nugget:hover {
    transform: scale(1.1);
}

.crumbs {
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
}

.stats {
    font-size: 24px;
    margin: 20px;
    background: white;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

.stats-container {
    position: fixed;
    right: 20px;
    top: 20px;
    background: white;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    font-size: 18px;
    text-align: center;
    min-width: 200px;
}

.stats-container h3 {
    margin: 0 0 10px 0;
    color: #ff4136;
}

.sauce {
    width: 50px;
    height: 50px;
    border-radius: 5px;
    margin: 10px;
    cursor: pointer;
    transition: transform 0.2s;
}

.sauce:hover {
    transform: scale(1.1);
}

#sauceContainer {
    display: flex;
    justify-content: center;
    margin: 20px;
}

.splash {
    position: absolute;
    pointer-events: none;
    animation: splashAnim 1s forwards;
}

@keyframes splashAnim {
    0% { transform: scale(0); opacity: 1; }
    100% { transform: scale(2); opacity: 0; }
}

.eaten {
    animation: eatNugget 0.5s forwards;
}

@keyframes eatNugget {
    0% { transform: scale(1); }
    50% { transform: scale(1.2); }
    100% { transform: scale(0); opacity: 0; }
}

#ronald {
    position: fixed;
    bottom: -150px;
    right: -150px;
    width: 300px;
    height: 300px;
    transition: transform 0.3s ease-in-out;
    cursor: pointer;
}

#ronald:hover {
    transform: translate(-50px, -50px);
}

.ronald-comment {
    position: fixed;
    bottom: 150px;
    right: 150px;
    background: white;
    padding: 15px;
    border-radius: 20px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    display: none;
    font-size: 18px;
}

.ronald-comment:after {
    content: '';
    position: absolute;
    bottom: -10px;
    right: 20px;
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid white;
}

.menu-items {
    display: flex;
    gap: 20px;
    margin: 20px;
}

.menu-item {
    cursor: pointer;
    transition: transform 0.2s;
    position: relative;
}

.menu-item:hover {
    transform: scale(1.1);
}

.bigmac {
    width: 80px;
    height: 70px;
    position: relative;
}

.fries-container {
    width: 60px;
    height: 80px;
    position: relative;
}

.grimace-shake {
    width: 50px;
    height: 90px;
    position: relative;
}

.auto-button {
    background: #4CAF50;
    border: none;
    color: white;
    padding: 15px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 10px;
    font-family: 'Comic Sans MS', cursive;
    transition: background-color 0.3s;
}

.auto-button:disabled {
    background: #cccccc;
    cursor: not-allowed;
}

.auto-button:hover:not(:disabled) {
    background: #45a049;
}
</style>
</head>
<body>
    <h1>üçó Chicken Nugget Simulator üçó</h1>
    <div class="stats">
        Nuggets Eaten: <span id="count">0</span>
    </div>
    <div class="stats-container">
        <h3>Today's Total</h3>
        <div style="font-size: 24px; margin: 10px 0;">
            <span id="todayCount">0</span> nuggets
        </div>
        <hr style="border: 1px solid #eee; margin: 10px 0;">
        <h3>All Time Total</h3>
        <div style="font-size: 24px; margin: 10px 0;">
            <span id="allTimeCount">0</span> nuggets
        </div>
    </div>
    <button id="autoEaterButton" class="auto-button" onclick="purchaseAutoEater()">
        Buy Auto-Eater (25 nuggets)
    </button>
    <div class="menu-items">
        <svg class="menu-item bigmac" onclick="consumeItem(this, 'bigmac')" viewBox="0 0 100 100">
            <rect x="20" y="30" width="60" height="10" rx="5" fill="#f0a500"/> <!-- Top bun -->
            <rect x="15" y="40" width="70" height="5" fill="#2d961f"/> <!-- Lettuce -->
            <rect x="20" y="45" width="60" height="10" fill="#8b4513"/> <!-- Patty -->
            <rect x="15" y="55" width="70" height="5" fill="#2d961f"/> <!-- Lettuce -->
            <rect x="20" y="60" width="60" height="10" rx="5" fill="#f0a500"/> <!-- Bottom bun -->
        </svg>
        
        <svg class="menu-item fries-container" onclick="consumeItem(this, 'fries')" viewBox="0 0 100 100">
            <rect x="20" y="40" width="60" height="50" fill="#ff0000"/> <!-- Container -->
            <rect x="30" y="10" width="8" height="40" fill="#f0a500"/> <!-- Fry -->
            <rect x="45" y="5" width="8" height="45" fill="#f0a500"/> <!-- Fry -->
            <rect x="60" y="8" width="8" height="42" fill="#f0a500"/> <!-- Fry -->
        </svg>
        
        <svg class="menu-item grimace-shake" onclick="consumeItem(this, 'shake')" viewBox="0 0 100 100">
            <rect x="30" y="20" width="40" height="60" fill="#6a0dad"/> <!-- Cup -->
            <path d="M 25 20 L 75 20 L 65 10 L 35 10 Z" fill="#6a0dad"/> <!-- Lid -->
            <rect x="45" y="10" width="10" height="15" fill="#ffffff"/> <!-- Straw -->
            <ellipse cx="50" cy="30" rx="15" ry="5" fill="#ffffff"/> <!-- Whipped cream -->
        </svg>
    </div>
    <div id="sauceContainer">
        <div class="sauce" style="background: #ff4136;" onclick="selectSauce('ketchup')"></div>
        <div class="sauce" style="background: #ff851b;" onclick="selectSauce('bbq')"></div>
        <div class="sauce" style="background: #ffdc00;" onclick="selectSauce('honey-mustard')"></div>
        <div class="sauce" style="background: #39cccc;" onclick="selectSauce('ranch')"></div>
    </div>
    <div id="nuggetContainer" class="nugget" onclick="eatNugget()">
        <div class="crumbs"></div>
    </div>

    <div class="ronald-comment" id="ronaldComment"></div>
    <svg id="ronald" viewBox="0 0 100 100" onclick="ronaldSpeak()">
        <circle cx="50" cy="50" r="45" fill="#ff0000"/>
        <circle cx="50" cy="40" r="25" fill="#fff"/>
        <path d="M 30 35 Q 50 60 70 35" stroke="#ff0000" stroke-width="5" fill="none"/>
        <circle cx="40" cy="30" r="3" fill="#000"/>
        <circle cx="60" cy="30" r="3" fill="#000"/>
        <path d="M 20 20 Q 50 10 80 20" stroke="#ffff00" stroke-width="8" fill="none"/>
        <rect x="35" y="15" width="30" height="5" fill="#ff0000"/>
    </svg>

<script>
let count = 0;
let todayCount = 0;
let currentSauce = '';
let autoEaterActive = false;
let autoEaterInterval;
let room = new WebsimSocket();

const sauceColors = {
    'ketchup': '#ff4136',
    'bbq': '#ff851b',
    'honey-mustard': '#ffdc00',
    'ranch': '#39cccc'
};

const ronaldPhrases = [
    "Ba da ba ba ba, I'm lovin' it!",
    "Those nuggets look McMagnificent!",
    "Need some McNugget wisdom?",
    "Keep on nugget-ing!",
    "You're doing a McTastic job!",
    "That's some serious nugget action!",
    "Want fries with those nuggets?",
    "McDelicious choices you're making!",
    "Try the Grimace Shake!",
    "Big Mac Attack!",
    "Would you like fries with that?"
];

function updateStatsDisplay(stats) {
    if (!stats) {
        document.getElementById('todayCount').textContent = '0';
        return;
    }
    // Just show the total for today across all players
    document.getElementById('todayCount').textContent = stats.total;
}

async function initializeCounts() {
    const today = new Date().toDateString();
    
    // Get both current stats and all-time stats
    let stats = await room.store.get('dailyStats');
    let allTimeStats = await room.store.get('allTimeStats');
    
    if (!stats || stats.date !== today) {
        await room.store.update({
            id: 'dailyStats',
            dependencies: { today },
            updateFunction: () => ({
                date: today,
                players: {},
                total: 0
            })
        });
    }
    
    if (!allTimeStats) {
        await room.store.update({
            id: 'allTimeStats',
            dependencies: {},
            updateFunction: () => ({
                total: 0
            })
        });
    }
    
    updateStatsDisplay(stats);
    updateAllTimeDisplay(allTimeStats);
}

function updateAllTimeDisplay(stats) {
    if (!stats) {
        document.getElementById('allTimeCount').textContent = '0';
        return;
    }
    document.getElementById('allTimeCount').textContent = stats.total;
}

function consumeItem(element, type) {
    element.style.transform = 'scale(0)';
    let message = '';
    
    switch(type) {
        case 'bigmac':
            message = "That's a mighty Big Mac!";
            count += 10;
            break;
        case 'fries':
            message = "World famous fries!";
            count += 5;
            break;
        case 'shake':
            message = "They call me Grimace!";
            count += 8;
            break;
    }
    
    document.getElementById('count').textContent = count;
    ronaldSpeak(message);
    
    // Reset the item after animation
    setTimeout(() => {
        element.style.transform = '';
    }, 500);

    // Update the daily stats
    const today = new Date().toDateString();
    const username = room.party.client.username;
    
    room.store.update({
        id: 'dailyStats',
        dependencies: { today, username },
        updateFunction: (stats) => {
            if (!stats || stats.date !== today) {
                return {
                    date: today,
                    players: {
                        [username]: 1
                    },
                    total: 1
                };
            }

            const newStats = {
                ...stats,
                players: {
                    ...stats.players,
                    [username]: (stats.players[username] || 0) + 1
                },
                total: stats.total + 1
            };

            return newStats;
        }
    });
}

function eatNugget() {
    const nugget = document.getElementById('nuggetContainer');
    nugget.classList.add('eaten');
    
    count++;
    const today = new Date().toDateString();
    const username = room.party.client.username;

    // Update daily stats
    room.store.update({
        id: 'dailyStats',
        dependencies: { today, username },
        updateFunction: (stats) => {
            if (!stats || stats.date !== today) {
                return {
                    date: today,
                    players: {
                        [username]: 1
                    },
                    total: 1
                };
            }

            const newStats = {
                ...stats,
                players: {
                    ...stats.players,
                    [username]: (stats.players[username] || 0) + 1
                },
                total: stats.total + 1
            };

            return newStats;
        }
    });
    
    // Update all-time stats
    room.store.update({
        id: 'allTimeStats',
        dependencies: {},
        updateFunction: (stats) => {
            if (!stats) {
                return { total: 1 };
            }
            return { total: stats.total + 1 };
        }
    });

    document.getElementById('count').textContent = count;
    
    if (currentSauce) {
        const rect = nugget.getBoundingClientRect();
        for (let i = 0; i < 5; i++) {
            const randomX = rect.left + Math.random() * rect.width;
            const randomY = rect.top + Math.random() * rect.height;
            createSplash(randomX, randomY);
        }
    }

    if (count % 5 === 0) {
        ronaldSpeak();
    }

    setTimeout(() => {
        nugget.classList.remove('eaten');
        generateNewNuggetShape();
    }, 500);
}

function generateNewNuggetShape() {
    const nugget = document.getElementById('nuggetContainer');
    const randomWidth = 80 + Math.random() * 40;
    const randomHeight = 50 + Math.random() * 30;
    const randomRadius = 20 + Math.random() * 20;
    
    nugget.style.width = randomWidth + 'px';
    nugget.style.height = randomHeight + 'px';
    nugget.style.borderRadius = randomRadius + 'px';
    
    nugget.style.transform = `rotate(${Math.random() * 360}deg)`;
    
    const crumbs = nugget.querySelector('.crumbs');
    crumbs.innerHTML = '';
    for (let i = 0; i < 5; i++) {
        const spot = document.createElement('div');
        spot.style.position = 'absolute';
        spot.style.width = (5 + Math.random() * 10) + 'px';
        spot.style.height = (5 + Math.random() * 10) + 'px';
        spot.style.background = '#d4a23b';
        spot.style.borderRadius = '50%';
        spot.style.left = (Math.random() * 100) + '%';
        spot.style.top = (Math.random() * 100) + '%';
        crumbs.appendChild(spot);
    }
}

function purchaseAutoEater() {
    if (count >= 25 && !autoEaterActive) {
        count -= 25;
        document.getElementById('count').textContent = count;
        autoEaterActive = true;
        document.getElementById('autoEaterButton').disabled = true;
        document.getElementById('autoEaterButton').textContent = 'Auto-Eater Active';
        
        autoEaterInterval = setInterval(() => {
            eatNugget();
        }, 1000);
        
        ronaldSpeak("Now that's what I call automation!");
    } else if (autoEaterActive) {
        ronaldSpeak("You already have an Auto-Eater!");
    } else {
        ronaldSpeak("You need 25 nuggets first!");
    }
}

// Initialize first nugget
generateNewNuggetShape();

// Initialize the counts when the page loads
initializeCounts();

room.onRecordChanged = (id) => {
    if (id === 'dailyStats') {
        room.store.get('dailyStats').then(stats => {
            updateStatsDisplay(stats);
        });
    }
    if (id === 'allTimeStats') {
        room.store.get('allTimeStats').then(stats => {
            updateAllTimeDisplay(stats);
        });
    }
};

function ronaldSpeak(customMessage = null) {
    const commentBox = document.getElementById('ronaldComment');
    
    // Use custom message if provided, otherwise get random phrase
    const message = customMessage || ronaldPhrases[Math.floor(Math.random() * ronaldPhrases.length)];
    
    commentBox.textContent = message;
    commentBox.style.display = 'block';
    
    // Hide the message after 3 seconds
    setTimeout(() => {
        commentBox.style.display = 'none';
    }, 3000);
}

function selectSauce(sauce) {
    currentSauce = sauce;
    
    // Reset all sauce borders
    document.querySelectorAll('.sauce').forEach(el => {
        el.style.border = 'none';
    });
    
    // Highlight selected sauce
    const sauceElement = document.querySelector(`.sauce[onclick*="${sauce}"]`);
    sauceElement.style.border = '3px solid #333';
    
    ronaldSpeak(`Mmm, ${sauce} sauce!`);
}

function createSplash(x, y) {
    const splash = document.createElement('div');
    splash.className = 'splash';
    splash.style.left = x + 'px';
    splash.style.top = y + 'px';
    splash.style.width = '10px';
    splash.style.height = '10px';
    splash.style.background = sauceColors[currentSauce];
    splash.style.borderRadius = '50%';
    splash.style.position = 'fixed';
    
    document.body.appendChild(splash);
    
    // Remove the splash element after animation completes
    setTimeout(() => {
        splash.remove();
    }, 1000);
}
</script>
</body></html>