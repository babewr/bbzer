<style>
    :root {
        --bg-color: #FFF0F5;
        --text-color: #333;
        --header-bg: #FFB6C1;
        --header-color: #FF1493;
        --button-bg: #FF1493;
        --button-color: white;
        --headcanon-bg: #FFC0CB;
        --headcanon-item-bg: #FFF;
    }

    .dark-mode {
        --bg-color: #2A2A2A;
        --text-color: #E0E0E0;
        --header-bg: #4A0E1C;
        --header-color: #FF69B4;
        --button-bg: #FF69B4;
        --button-color: #2A2A2A;
        --headcanon-bg: #3D0F1A;
        --headcanon-item-bg: #1F1F1F;
    }

    body {
        font-family: 'Comic Sans MS', cursive, sans-serif;
        background-color: var(--bg-color);
        margin: 0;
        padding: 0;
        color: var(--text-color);
        transition: background-color 0.3s, color 0.3s;
    }
    .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px 20px 40px; /* Increased bottom padding */
    }
    header {
        background-color: var(--header-bg);
        padding: 20px 0;
        text-align: center;
        position: relative;
    }
    h1 {
        font-size: 3em;
        color: var(--header-color);
        margin: 0;
        text-shadow: 2px 2px #FFC0CB;
    }
    .kitty-container {
        position: relative;
        width: 300px;
        height: 300px;
        margin: 50px auto;
    }
    .kitty {
        position: absolute;
        width: 100%;
        height: 100%;
        background-color: #808080;
        border-radius: 50%;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    .ear {
        position: absolute;
        width: 0;
        height: 0;
        border-left: 50px solid transparent;
        border-right: 50px solid transparent;
        border-bottom: 80px solid #808080;
        transition: border-bottom-color 0.3s;
    }
    .ear-left {
        top: -40px;
        left: 20px;
        transform: rotate(-30deg);
    }
    .ear-right {
        top: -40px;
        right: 20px;
        transform: rotate(30deg);
    }
    .eye {
        position: absolute;
        width: 60px;
        height: 60px;
        background-color: #FFFF00;
        border-radius: 50%;
        top: 80px;
        transition: height 0.3s;
    }
    .eye-left {
        left: 60px;
    }
    .eye-right {
        right: 60px;
    }
    .pupil {
        position: absolute;
        width: 30px;
        height: 30px;
        background-color: #000;
        border-radius: 50%;
        top: 15px;
        left: 15px;
        transition: left 0.3s;
    }
    .nose {
        position: absolute;
        width: 30px;
        height: 20px;
        background-color: #FFC0CB;
        border-radius: 50%;
        top: 180px;
        left: 135px;
    }
    .mouth {
        position: absolute;
        width: 100px;
        height: 60px;
        border: 10px solid #000;
        border-radius: 0 0 100px 100px;
        border-top: none;
        top: 200px;
        left: 100px;
        transition: height 0.3s, border-radius 0.3s;
    }
    .angy-meter {
        background-color: var(--headcanon-item-bg);
        border: 2px solid var(--button-bg);
        border-radius: 20px;
        height: 30px;
        margin: 20px auto;
        position: relative;
        width: 80%;
    }
    .angy-level {
        background-color: var(--button-bg);
        border-radius: 20px;
        height: 100%;
        width: 75%;
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 0.7; }
        50% { opacity: 1; }
        100% { opacity: 0.7; }
    }
    .headcanons {
        background-color: var(--headcanon-bg);
        border-radius: 10px;
        padding: 20px;
        margin-top: 30px;
    }
    .headcanon {
        background-color: var(--headcanon-item-bg);
        border-radius: 5px;
        padding: 10px;
        margin-bottom: 10px;
        display: flex;
        align-items: flex-start;
    }
    .headcanon-form {
        margin-top: 20px;
    }
    .headcanon-form textarea {
        width: 100%;
        height: 100px;
        margin-bottom: 10px;
        background-color: var(--headcanon-item-bg);
        color: var(--text-color);
        border: 1px solid var(--button-bg);
    }
    .submit-btn {
        background-color: var(--button-bg);
        border: none;
        border-radius: 25px;
        color: var(--button-color);
        cursor: pointer;
        font-size: 1.2em;
        padding: 10px 20px;
    }
    .submit-btn:hover {
        opacity: 0.8;
    }
    .creator-tag {
        background-color: #79e1ff;
        color: #274eca;
        padding: 2px 5px;
        border-radius: 3px;
        font-size: 0.8em;
        margin-left: 5px;
    }
    .settings-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: var(--button-bg);
        color: var(--button-color);
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 20px;
        cursor: pointer;
    }
    .settings-panel {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: var(--headcanon-bg);
        padding: 20px;
        border-radius: 10px;
        z-index: 1000;
    }
    .profile-pic {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        margin-right: 10px;
    }
    .media-preview {
        max-width: 100%;
        margin-top: 10px;
    }
    #media-upload {
        margin-top: 10px;
    }
</style>
</head>
<body>
    <header>
        <h1>Angy Kitty Headcanons &amp; Playtime</h1>
        <button class="settings-btn" onclick="toggleSettings()">&#x2699;&#xfe0f;</button>
    </header>
    <div class="container">
        <div class="kitty-container">
            <div class="kitty" onclick="pokeKitty()">
                <div class="ear ear-left"></div>
                <div class="ear ear-right"></div>
                <div class="eye eye-left"><div class="pupil"></div></div>
                <div class="eye eye-right"><div class="pupil"></div></div>
                <div class="nose"></div>
                <div class="mouth"></div>
            </div>
        </div>
        <div class="angy-meter">
            <div class="angy-level"></div>
        </div>
        <div class="headcanons">
            <h2>Angy Kitty Headcanons</h2>
            <div id="headcanon-list">
                <!-- Headcanons will be dynamically added here -->
            </div>
            <div class="headcanon-form">
                <textarea id="new-headcanon" placeholder="Write your Angy Kitty headcanon here..."></textarea>
                <input type="file" id="media-upload" accept="image/*,video/*,audio/*">
                <div id="media-preview"></div>
                <button class="submit-btn" onclick="submitHeadcanon()">Submit Headcanon</button>
            </div>
        </div>
    </div>
    <div class="settings-panel" id="settings-panel">
        <h3>Settings</h3>
        <label>
            <input type="checkbox" id="dark-mode-toggle" onchange="toggleDarkMode()">
            Dark Mode
        </label>
        <br>
        <label>
            Profile Picture URL:
            <input type="text" id="profile-pic-url">
        </label>
        <button onclick="updateProfilePic()">Update</button>
        <button onclick="toggleSettings()">Close</button>
    </div>

<script>const room = new WebsimSocket();
let angyLevel = 0;
let profilePicUrl = 'https://i.pinimg.com/originals/f1/0f/f7/f10ff70a7155e5ab666bcdd1b45b726d.jpg';
room.onmessage = event => {
  const data = event.data;
  switch (data.type) {
    case 'new_headcanon':
      addHeadcanon(data.headcanon);
      break;
    case 'angy_update':
      updateAngyLevel(data.level);
      break;
    case 'connected':
    case 'disconnected':
      updateOnlinePlayers();
      break;
  }
};
function pokeKitty() {
  if (angyLevel < 100) {
    angyLevel += 5;
    room.send({
      type: 'angy_update',
      level: angyLevel
    });
    updateAngyMeter();
    updateKittyFace();
  }
  if (angyLevel >= 100) {
    alert("MAXIMUM ANGY ACHIEVED! ðŸ˜¾ðŸ™€");
  }
}
function updateAngyLevel(level) {
  angyLevel = level;
  updateAngyMeter();
  updateKittyFace();
}
function updateAngyMeter() {
  const angyLevelElement = document.querySelector('.angy-level');
  angyLevelElement.style.width = angyLevel + '%';
}
function updateKittyFace() {
  const kitty = document.querySelector('.kitty');
  const ears = document.querySelectorAll('.ear');
  const eyes = document.querySelectorAll('.eye');
  const pupils = document.querySelectorAll('.pupil');
  const mouth = document.querySelector('.mouth');
  const angyColor = `rgb(128, ${128 - angyLevel}, ${128 - angyLevel})`;
  kitty.style.backgroundColor = angyColor;
  ears.forEach(ear => ear.style.borderBottomColor = angyColor);
  eyes.forEach(eye => eye.style.height = `${60 - angyLevel / 5}px`);
  pupils.forEach(pupil => pupil.style.left = `${15 + angyLevel / 10}px`);
  mouth.style.height = `${60 + angyLevel / 2}px`;
  mouth.style.borderRadius = `0 0 ${100 + angyLevel}px ${100 + angyLevel}px`;
}
function addHeadcanon(headcanon) {
  const headcanonList = document.getElementById('headcanon-list');
  const headcanonElement = document.createElement('div');
  headcanonElement.className = 'headcanon';
  headcanonElement.innerHTML = `
        <img src="${headcanon.profilePic}" alt="${headcanon.username}" class="profile-pic">
        <div>
            <strong>${headcanon.username}</strong>
            ${headcanon.isCreator ? '<span class="creator-tag">I CREATED ANGY KITTY AND IM PROUD</span>' : ''}:
            ${headcanon.text}
            ${headcanon.media ? `<br><img src="${headcanon.media}" alt="User media" class="media-preview">` : ''}
        </div>
    `;
  headcanonList.appendChild(headcanonElement);
}
function submitHeadcanon() {
  const newHeadcanon = document.getElementById('new-headcanon').value;
  const mediaUpload = document.getElementById('media-upload').files[0];
  if (newHeadcanon.trim() !== '') {
    const headcanon = {
      username: room.party.client.username,
      profilePic: profilePicUrl,
      text: newHeadcanon,
      isCreator: room.party.client.username === 'ruko'
    };
    if (mediaUpload) {
      const reader = new FileReader();
      reader.onload = function (e) {
        headcanon.media = e.target.result;
        room.send({
          type: 'new_headcanon',
          headcanon: headcanon
        });
      };
      reader.readAsDataURL(mediaUpload);
    } else {
      room.send({
        type: 'new_headcanon',
        headcanon: headcanon
      });
    }
    document.getElementById('new-headcanon').value = '';
    document.getElementById('media-upload').value = '';
    document.getElementById('media-preview').innerHTML = '';
  }
}
function toggleSettings() {
  const settingsPanel = document.getElementById('settings-panel');
  settingsPanel.style.display = settingsPanel.style.display === 'none' ? 'block' : 'none';
}
function toggleDarkMode() {
  document.body.classList.toggle('dark-mode');
}
function updateProfilePic() {
  profilePicUrl = document.getElementById('profile-pic-url').value;
  toggleSettings();
}
function updateOnlinePlayers() {
  console.log('Online players:', Object.keys(room.party.peers).length);
}
document.getElementById('media-upload').addEventListener('change', function (event) {
  const file = event.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function (e) {
      const preview = document.getElementById('media-preview');
      preview.innerHTML = '';
      if (file.type.startsWith('image/')) {
        const img = document.createElement('img');
        img.src = e.target.result;
        img.className = 'media-preview';
        preview.appendChild(img);
      } else if (file.type.startsWith('video/')) {
        const video = document.createElement('video');
        video.src = e.target.result;
        video.className = 'media-preview';
        video.controls = true;
        preview.appendChild(video);
      } else if (file.type.startsWith('audio/')) {
        const audio = document.createElement('audio');
        audio.src = e.target.result;
        audio.className = 'media-preview';
        audio.controls = true;
        preview.appendChild(audio);
      }
    };
    reader.readAsDataURL(file);
  }
});
updateKittyFace();
updateOnlinePlayers();</script>
</body>
</html>